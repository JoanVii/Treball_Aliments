---
title: "Treball aliments"
author: "JV"
date: "29/12/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

directori <- getwd()

library(readxl)
library(tidyverse)


# lectura de dades:
practica_1 <- read_excel(paste0(directori, "/Ignorar/Practica 1.xlsx"))
practica_21 <- read_excel(paste0(directori, "/Ignorar/Practica 21.xlsx"))
practica_22 <- read_excel(paste0(directori, "/Ignorar/Practica 22.xlsx"))
practica_31 <- read_excel(paste0(directori, "/Ignorar/Practica 31.xlsx"))
practica_32 <- read_excel(paste0(directori, "/Ignorar/Practica 32.xlsx"))
practica_33 <- read_excel(paste0(directori, "/Ignorar/Practica 33.xlsx"))
practica_4 <- read_excel(paste0(directori, "/Ignorar/Practica 4.xlsx"))

```

# Pràctica 1:


## Grafics Pràctica 1:

```{r gràfic pràctica 1}
# modificat de paractica 4 a practica 1

# p <- ggplot(
#   practica_1,
#   aes("Tipus de mostra", "Mitjana")
# )
# p
# 
# p <- p + 
#   geom_bar(stat='identity') + 
#   geom_errorbar(
#      aes(x="Tipus de mostra", ymin="Mitjana" - "Error", ymax= "Mitjana" + "Error"),
#      width=0.1, colour="black",
#      alpha=1,
#      size=0.3) + 
#   labs (x = "Tipus de mostra", y = "% Humitat", title = "Percentatge d'humitat en funció de cada Tipus de # formatge"  )
# 
# p <- p + scale_fill_brewer(palette = "Dark2")
# p
```

El shapiro test ens permet contrastar la normalitat d'un conjunt de dades. Així, la hipòtesi nul·la que es planteja és que les mostres segueixen una distribució normal (ho he cercat wiki però es pot contrastar)

```{r test_practica_1}
data <- practica_1
colnames(data) <- c("Mostra", "Contingut", "Mitjana", "Error")

shapiro.test(data$Contingut)

# suposam normalitat (si no hi ha normalitat tot i aixi ho feim)
one.way <- aov(data$Contingut ~ data$Mostra)
summary(one.way)

pwc <- pairwise.t.test(data$Contingut, data$Mostra, paired = FALSE,  p.adjust.method = "bonferroni")
pwc

# suposam NO normalitat
kt <- kruskal.test(data$Contingut ~ data$Mostra)
kt

pwc2 <- pairwise.wilcox.test(data$Contingut, data$Mostra, paired = FALSE, p.adjust.method = "holm")
pwc2
```



# Practica 2

## Pràctica 2.1.


## Including Plots

```{r gràfic pràctica 2.1.}
# titol <- 
#p_21 <- ggplot(
#  practica_21,
#  aes("Formatge", "Mitjana", fill="Formatge")
#)
#
#p_31 <- p_21 +
#  geom_bar(stat='identity') +
#  geom_errorbar( aes(x="Formatge", ymin="Mitjana" - "Error", ymax= "Mitjana" + "Error"),
#                 width=0.1, colour="black", alpha=1, size=0.3) +
#  labs (x = "Tipus de formatge", y = "% Humitat", title = "Percentatge d'humitat en funció de cada Tipus de formatge"  )
#
#p_31 <- p_31 + scale_fill_brewer(palette = "Dark2")
#p_31
# save png
```

El shapiro test ens permet contrastar la normalitat d'un conjunt de dades. Així, la hipòtesi nul·la que es planteja és que les mostres segueixen una distribució normal (ho he cercat wiki però es pot contrastar)

```{r Shafiro test 22_}
data <- practica_22
colnames(data) <- c("Mostra", "Contingut", "Mitjana", "Error")

shapiro.test(data$Contingut)

one.way <- aov(data$Contingut ~ data$Mostra)
summary(one.way)

pwc <- pairwise.t.test(data$Contingut, data$Mostra, paired = FALSE,  p.adjust.method = "bonferroni")
pwc

kt <- kruskal.test(data$Contingut ~ data$Mostra)
kt

pwc2 <- pairwise.wilcox.test(data$Contingut, data$Mostra, paired = FALSE, p.adjust.method = "holm")
pwc2
```

# Pràctica 2.2

```{r processament dades pràctica 22}
practica_32 <- read_excel(paste0(directori, "/Ignorar/Practica 32.xlsx"))
## !!!

```

## Including Plots

```{r gràfic pràctica 22}

p2 <- ggplot(practica_32, aes("Tipus de mostra", "Mitjana", fill="Tipus de mostra"))

#p2 <- p2 + geom_bar(stat='identity') + geom_errorbar( aes(x="Tipus de mostra", ymin="Mitjana" - "Error", ymax= "Mitjana" + "Error"), width=0.1, colour="black", alpha=1, size=0.3) + labs (x = "Tipus de Mostra", y = "% Humitat", title = "Percentatge d'humitat en funció de cada Tipus de formatge"  )

p2 <- p2 + scale_fill_brewer(palette = "Dark2")
p2
```

El shapiro test ens permet contrastar la normalitat d'un conjunt de dades. Així, la hipòtesi nul·la que es planteja és que les mostres segueixen una distribució normal (ho he cercat wiki però es pot contrastar)

```{r Shafiro test 22}
data <- practica_22
colnames(data) <- c("Mostra", "Contingut", "Mitjana", "Error")

shapiro.test(data$Contingut)

one.way <- aov(data$Contingut ~ data$Mostra)
summary(one.way)

pwc <- pairwise.t.test(data$Contingut, data$Mostra, paired = FALSE,  p.adjust.method = "bonferroni")
pwc

kt <- kruskal.test(data$Contingut ~ data$Mostra)
kt

pwc2 <- pairwise.wilcox.test(data$Contingut, data$Mostra, paired = FALSE, p.adjust.method = "holm")
pwc2
```


# Practica 3


## Pràctica 3.1.
```{r _gràfic pràctica 3.1.}

# p_31 <- ggplot(practica_31, aes("Formatge", "Mitjana", fill="Formatge"))
# 
# p_31 <- p_31 +
#   geom_bar(stat='identity') + 
#   geom_errorbar( aes(x="Formatge", ymin="Mitjana" - "Error", ymax= "Mitjana" + "Error"), 
#                  width=0.1, colour="black", alpha=1, size=0.3) + 
#   labs (x = "Tipus de formatge", y = "% Humitat", title = "Percentatge d'humitat en funció de cada Tipus de formatge"  )
# 
# p_31 <- p_31 + scale_fill_brewer(palette = "Dark2")
# p_31
```

```{r _Shafiro test 3.1}
data <- practica_31
colnames(data) <- c("Mostra", "Contingut", "Mitjana", "Error")

shapiro.test(data$Contingut)

one.way <- aov(data$Contingut ~ data$Mostra)
summary(one.way)

pwc <- pairwise.t.test(data$Contingut, data$Mostra, paired = FALSE,  p.adjust.method = "bonferroni")
pwc

kt <- kruskal.test(data$Contingut ~ data$Mostra)
kt

pwc2 <- pairwise.wilcox.test(data$Contingut, data$Mostra, paired = FALSE, p.adjust.method = "holm")
pwc2
```

# Pràctica 3.2

## Including Plots

```{r _gràfic pràctica 32}
#practica_2_proc<-practica_2_proc %>% select(Muestra,M,SEM)
#plot <- practica_2_proc[!duplicated(practica_2_proc$Muestra),]

# p2 <- ggplot(practica_32, aes("Tipus de mostra", "Mitjana", fill="Tipus de mostra"))
# 
# p2 <- p2 + 
#   geom_bar(stat='identity') + 
#   geom_errorbar( aes(x="Tipus de mostra", ymin="Mitjana" - "Error", ymax= "Mitjana" + "Error")
#                  , width=0.1, colour="black", alpha=1, size=0.3) + 
#   labs (x = "Tipus de Mostra", y = "% Humitat", title = "Percentatge d'humitat en funció de cada Tipus de formatge"  )
# 
# p2 <- p2 + scale_fill_brewer(palette = "Dark2")
# p2
```

```{r _Shafiro test 32}
data <- practica_32
colnames(data) <- c("Mostra", "Contingut", "Mitjana", "Error")

shapiro.test(data$Contingut)

one.way <- aov(data$Contingut ~ data$Mostra)
summary(one.way)

pwc <- pairwise.t.test(data$Contingut, data$Mostra, paired = FALSE,  p.adjust.method = "bonferroni")
pwc

kt <- kruskal.test(data$Contingut ~ data$Mostra)
kt

pwc2 <- pairwise.wilcox.test(data$Contingut, data$Mostra, paired = FALSE, p.adjust.method = "holm")
pwc2
```

# Pràctica 3.3.

## Including Plots

```{r _gràfic pràctica 33}
#practica_2_proc<-practica_2_proc %>% select(Muestra,M,SEM)
#plot <- practica_2_proc[!duplicated(practica_2_proc$Muestra),]

#p3 <- ggplot(practica33, aes("Formatge", "Mitjana", fill="Formatge"))
#
#p3 <- p3 + geom_bar(stat='identity') +
#  geom_errorbar( aes(x="Formatge", ymin="Mitjana" - "Error", ymax= "Mitjana" + "Error"),
#                 width=0.1, colour="black", alpha=1, size=0.3) + 
#  labs (x = "Tipus de Mostra", y = "% Humitat", title = "Percentatge d'humitat en funció de cada Tipus de formatge"  )
#
#p3 <- p3 + scale_fill_brewer(palette = "Dark2")
#p3
```


```{r _Shafiro test 33}
data <- practica_33
colnames(data) <- c("Mostra", "Contingut", "Mitjana", "Error")

shapiro.test(data$Contingut)

one.way <- aov(data$Contingut ~ data$Mostra)
summary(one.way)

pwc <- pairwise.t.test(data$Contingut, data$Mostra, paired = FALSE,  p.adjust.method = "bonferroni")
pwc

kt <- kruskal.test(data$Contingut ~ data$Mostra)
kt

pwc2 <- pairwise.wilcox.test(data$Contingut, data$Mostra, paired = FALSE, p.adjust.method = "holm")
pwc2
```



# Practica 4

## Including Plots

```{r __gràfic pràctica 1}
# p <- ggplot(practica_4, aes("Embutit", "Mitjana", fill="Embutit"))
# 
# p <- p +
#   geom_bar(stat='identity') +
#   geom_errorbar( aes(x="Embutit", ymin="Mitjana" - "Error", ymax= "Mitjana" + "Error"),
#                  width=0.1, colour="black", alpha=1, size=0.3) +
#   labs (x = "Embutit", y = "% Humitat", title = "Percentatge d'humitat en funció de cada Tipus de formatge"  )
# 
# p <- p + scale_fill_brewer(palette = "Dark2")
# p
```


```{r __Shafiro test}
data <- practica_4
colnames(data) <- c("Mostra", "Contingut", "Mitjana", "Error")

shapiro.test(data$Contingut)

one.way <- aov(data$Contingut ~ data$Mostra)
summary(one.way)

pwc <- pairwise.t.test(data$Contingut, data$Mostra, paired = FALSE,  p.adjust.method = "bonferroni")
pwc

kt <- kruskal.test(data$Contingut ~ data$Mostra)
kt

pwc2 <- pairwise.wilcox.test(data$Contingut, data$Mostra, paired = FALSE, p.adjust.method = "holm")
pwc2
```
